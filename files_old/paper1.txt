# Revisiting Grid-Forming and Grid-Following

Inverters: A Duality Theory

Yitong Li\({}^{\text{\textcircled{C}}}\), _Member, IEEE_, Yunjie Gu\({}^{\text{\textcircled{C}}}\), _Senior Member, IEEE_, and Timothy C. Green \({}^{\text{\textcircled{C}}}\), _Fellow, IEEE_

Manuscript received 24 June 2021; revised 30 October 2021 and 28 January 2022; accepted 12 February 2022. Date of publication 16 February 2022; date of current version 20 October 2022. This work was supported by the Engineering and Physical Sciences Research Council of UK (EPSRC) under Awards EP/S000909/1 and EP/T021780/1. Paper no. TPWRS-00996-2021. _(Corresponding author: Yitong Li and Timothy C. Green are with the Department of Electrical and Electronic Engineering, Imperial College, SW72AZ London, U.K. (e-mail: yitong.li15@iperperial.ac.uk; t.green@imperial.ac.uk).Yunjie Gu is with the Department of Electronic and Electrical Engineering, University of Bath, BA27AY Bath, U.K. (e-mail: yg934@bath.ac.uk).Color versions of one or more figures in this article are available at [https://doi.o
rg/10.1109/TPWRS-2022.3151851](https://doi.org/10.1109/TPWRS-2022.3151851) Digital Object Identifier Identifier 0.1109/TPWRS.2022.3151851

###### Abstract

Power electronic converters for integrating renewable energy resources into power systems can be divided into grid-forming and grid-following inverters. They possess certain similarities, but several important differences, which means that the relationship between them is quite subtle and sometimes obscure. In this article, a new perspective based on _duality_ is proposed to create new insights. It successfully unifies the grid interfacing and synchronization characteristics of the two inverter types in a symmetric, elegant, and technology-neutral form. Analysis shows that the grid-forming and grid-following inverters are _duals_ of each other in several ways including a) synchronization controllers: frequency droop control and phase-locked loop (PLL); b) grid-interfercing characteristics;
 current-following voltage-forming and voltage-following current-forming; c) swing characteristics: current-angle swing and voltage-angle swing; d) inner-loop controllers: output impedance shaping and output admittance shaping; and e) grid strength compatibility; strong-grid instability and weak-grid instability. The swing equations are also derived in dual form, which reveal the dynamic interaction between the grid strength, the synchronization controllers, and the inner-loop controllers. Insights are generated into cases of poor stability in both small-signal and transient/large-signal. The theoretical analysis and simulation results are used to illustrate cases for single-inverter systems, two-inverter systems, and multi-inverter networks.

 Duality, synchronization, frequency droop control, phase-locked loop (PLL), grid-forming inverter (GFM), grid-following inverter (GFL), grid strength.

0885-8950 0 2022 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. Sec [https://www.ieee.org/publications/ights/index.html](https://www.ieee.org/publications/ights/index.html) for more information.

## I Introduction

The imperative to adopt low-carbon energy is bringing about connection of large volumes of renewable energy resources and other supporting resources (including wind turbines, solar arrays, battery storage and fuel cells) to power systems and these connections are via power electronic inverters [1]. Compared with synchronous generators which have rotor motion dynamics and well-established standard models [2], the grid-interfacing and grid-synchronization characteristics of these inverter-based resources (IBRs) have dynamics set by control algorithms of which there are many variants [1, 3, 4]. The central importance of the control algorithms of inverters brings flexibility to the system but with it come new control interaction and instability problems.

Power electronic inverters used for IBRs are normally classified into two types, as shown in Fig. 111: (a) grid-forming (GFM); and (b) grid-following (GFL). A grid-forming inverter controls the ac-side voltage and contributes to forming of a voltage-source grid. It synchronizes with the rest of the grid through frequency droop control (normally \(P-\omega\) droop), which is similar to the control a synchronous generator[4, 5, 6]. In contrast, a grid-following inverter controls the ac-side current, and follows the phase angle of the existing grid voltage through a phase-locked loop (PLL) [3, 7]. Grid-following inverters have already been widely used for integrating wind and solar energy into power grids due to their simple control structure, their mature PLL technology, and their feature of
 operating at a determined current (matching the maximum power point or dispatch point of the resource). However, the PLL has negative effects on the system stability especially when the grid is weak because of a large grid impedance [8, 9]. This problem is likely to arise more often and become more challenging worldwide as more and more synchronous generators are replaced by IBRs. Consequently, attention has turned in recent years to grid-forming inverters because of their synchronous-generator-like characteristics and their capability of operating in a weak grid without stiff voltage sources or even of forming a stand-alone grid [4, 6, 10].

Footnote 1: In order to highlight the duality relationships and to facilitate comparison, the figures and tables in this paper are always arranged with the frequency droop grid-forming inverter case on the left and the PLL grid-following inverter case on the right.

As reviewed in [3], the characteristics of grid-forming and grid-following inverters are significantly different and they are seen as distinct types of inverter with their own analysis tools and underpinning theory. However, intriguing similarities have also been reported in literature by researchers who have attempted to unify them. For example, [11, 12, 13] observed the structural resemblance between the frequency droop control of a grid-forming inverter (or a synchronous generator) and the PLL of a grid-following inverter when the grid impedance is taken into account. Additionally, note that the PLL that was investigated in [13] had been enhanced and is different from the widely-used fundamental PLL in [7]. In [14], the small-signal power-frequency relation of a grid-following inverter 
was derived, but by merging the PLL with the dc-link voltage controlto perform the analysis. These results are inspiring indeed, but are not yet symmetrical or as elegant as they might be because of two straightforward obstacles [3]: (a) a grid-forming inverter controls its ac-side voltage, but a grid-following inverter controls its ac-side current; (b) the frequency droop control establishes a relationship between frequency and active power, but a PLL establishes a relationship between frequency and grid voltage. These two differences have left the unification of two inverter types still an open question and has also obscured the relationship between.

In this article, a new perspective is developed that reveals a _duality_ in the relationship between the two inverter types in a technology-neutral form and provides an elegant framework to analyze them. The analysis will show that the frequency-droop control and the PLL of two inverter types are essentially _duals_ of each other. Further, the grid-forming and grid-following inverters can also be re-classified more precisely as _current-following voltage-forming inverter_ and _voltage-following current-forming inverter_, respectively. By deriving and analyzing the swing characteristics, the synchronization mechanisms and grid-interfacing dynamics of the two types can also be re-defined as _current-angle swing_ and _voltage-angle swing_, respectively. Based on the proposed duality theory, s
ome questions and controversies that have concerned the power engineering community in recent times can be answered intuitively and convincingly. The questions include: a) How can the relationship between grid-forming and grid-following be understood? b) How do the controllers (e.g., droop control, PLL, and voltage or current loops) interact with each other? c) Is a grid-forming inverter also vulnerable to certain grid strength conditions just as a grid-following inverter is vulnerable to weak grids? d) Can a grid-following inverter also operate in islanding mode,

Fig. 1: Inverters and their control structures in synchronous \(dq\) frame. (a) Grid-forming inverter with frequency droop control. (b) Grid-following inverter with PLL. (Note that the superscript \({}^{*}\) indicates the reference signal in this article.).

Fig. 3: Synchronization loops for single-inverter-infinite-bus systems. (a) Frequency droop grid-forming inverter. (b) PLL grid-following inverter.

Fig. 2: Synchronization loops. (a) Frequency droop control for grid-forming inverter. (b) Synchronous-reference-frame PLL for grid-following inverter.

like a grid-forming inverter? e) How to analyze the transient stability of grid-forming and grid-following inverters? Beyond answering these questions, the duality theory has the potential of inspiring new concepts and interpreting surprising phenomena, and providing fresh insights in power systems dominated by IBRs.

This article is organized as follows: Section II proposes a duality approach and elaborates it in various aspects. In Section III and Section IV, comprehensive analysis of swing characteristics reveals the duality of the synchronization stability of grid-forming and grid-following inverters in both small-signal and large-signal. Case studies are also investigated. Finally, Section V concludes the article.

## II Duality of Grid-Forming and Grid-Following Inverters

### _Duality of Synchronization Loops_

The synchronization functions of inverters are highlighted in red in Fig. 1, namely a frequency droop block for the grid-forming inverter and a PLL for the grid-following inverter. The control block diagram format for these two synchronization methods is illustrated in Fig. 22.

Footnote 2: The current flowing into the inverter is assumed as the positive direction (i.e., load/passive convention) in this article, except for Section IV-B which uses source/active convention for transient analysis of two-inverter swing interaction.

Examining first the droop control of a grid-forming inverter in (a1) in Fig. 2(a), we recall that \(P=v_{d}i_{d}+v_{q}i_{q}\), and note that, if \(v_{d}\) is constant and \(v_{q}\) is zero, \(P\)-\(\omega\) droop in (a1) is equivalent to \(i_{d}\)-\(\omega\) droop in (a2). This is valid within the voltage-loop bandwidth of the grid-forming inverter and with a zero reference for \(q\)-axis voltage. The droop controller \(G_{\text{FD}}\) normally has the form \(m\frac{1}{1+sT}\) where \(m\) is the droop gain and \(\frac{1}{1+sT}\) is a low-pass (LPF) which attenuates high-frequency noise. As will be discussed in Section III and as noted in [4, 5], this LPF also provides virtual inertia. For the grid-following inverter, (b2) in Fig. 2(b) shows the widely-used synchronous-reference-frame PLL. 
The PLL measures the voltage phase angle by controlling \(v_{q}\) to zero through a proportional-integral (PI) controller \(G_{\text{PLL}}\)\(=k_{p,\text{PLL}}+\frac{k_{q}\text{PLL}}{s}\). Recalling that reactive power is given by \(Q\)\(=v_{q}i_{d}-v_{d}i_{q}\) we note that \(v_{q}\) is also proportional to \(Q\) when \(i_{d}\) is constant and \(i_{q}\) is zero. This is valid within the current loop bandwidth (with a reference of zero for \(q\)-axis current). In other words, the \(v_{q}\)-PLL in (b2) is equivalent to \(Q\)-PLL in (b1).

By comparing Fig. 2(a) and (b) carefully, the duality can be identified. Specifically, a power-frequency droop is also a \(i_{d}\)-\(\omega\) droop that can be regarded as a PLL that tracks \(i_{d}\). This \(i_{d}\)-PLL has a phase-locking controller \(G_{\text{FD}}\) that is a proportional (droop) gain rather than a PI controller and hence steady-state tracking error is expected. As a dual, a PLL that tracks \(v_{q}\) can also be regarded as a \(v_{q}\)-\(\omega\) droop control. Its controller \(G_{\text{PLL}}\) is a PI droop gain without steady-state droop errors. In summary, and when putting aside the difference between \(G_{\text{FD}}\) and \(G_{\text{PLL}}\), the two synchronization methods are perfectly duals of each other: one tracks (or droops) \(i_{d}\) or \(P\) whereas the other 
tracks (or droops) \(v_{q}\) or \(Q\), as summarized in Table I. This duality view of the two synchronization methods drives rethinking the grid-forming and grid-following concepts that is expounded in the following subsections.

### _Duality of Grid-Forming and Grid-Following_

A very important point that is so common and often overlooked is recalled here: power grids nowadays are voltage sources by default and the connections of sources and loads are made in parallel. This choice has been driven by efficiency and power quality considerations [15]. In other words, the grid-forming and grid-following are more precisely voltage-forming and voltage-following. Additionally, the \(i_{d}\)-\(\omega\) droop (\(i_{d}\)-PLL) of the grid-forming inverter implies that it is current-following; and the current control of the grid-following inverter implies that it is current-forming. Hence, a frequency droop grid-forming inverter can be re-defined more precisely as a _current-following, voltage-forming inverter_ and, as a dual, a PLL grid-following inverter can also be re-def
ined more precisely as a _voltage-following, current-forming inverter_. In other words, the grid-interfacing features of two inverters are also perfectly duals in a technology-neutral form, as summarized in Table I.

### _Duality of Swing Characteristics_

It has been established that the frequency droop grid-forming inverter operates similarly (or in certain cases equivalently) to a virtual synchronous generator and synchronizes to a grid system through swing dynamics [4, 5]. By contrast, the swing of a PLL grid-following inverter is still ill-defined and under-researched [11, 14]. The swing characteristics of both inverters are derived in the next passage and further aspects of their duality are revealed.

#### Ii-C1 Frequency Droop Grid-Forming Inverter

The single-machine-infinite-bus system is a useful simple case to investigate the swing dynamics [2, 4]. Fig. 3(a) gives a model of the synchronization process similar to Fig. 2(a) but with an additional feedback path considering grid impedance \(Z_{g}\) and inverter impedance \(Z_{c}\). The representation of the inverter as a controlled voltage source reflects the current-following voltage-forming feature and the synchronization loop. Impedance \(Z_{c}\) incorporates the dynamics of the ac filter and of the inner voltage loop of the converter [4]. Fig. 4(a) is a re-casting of the model in small-signal form (for which variables are designated with ) and in the complex vector \(dq\) frame (variables designated with \(dq\pm\)) [4, 16, 17]3.

Footnote 3: We use complex \(dq\) frame (\(dq\pm\) frame) for the small-signal analysis in this article, which represents \(dq\) frame variables as space vectors and has more concise expression. The fundamentals of \(dq\pm\) frame are summarized in Appendix A.

The physical plant, the grid and inverter are represented in the steady frame (\(d^{\prime}q\pm\)) rotating at constant speed \(\Omega_{0}\) whereas the synchronization loop and voltage reference are represented in the local swing frame (\(dq\pm\)) rotating at frequency \(\omega\) given by the frequency droop control. The relationship between the steady and swing frames is illustrated in Fig. 5[18]. 4 The frame transformation \([T]\) between \(dq\pm\) and \(d^{\prime}q^{\prime}\pm\) reflects the synchronization dynamics [18, 19].

Footnote 4: The swing frame and steady frames are also known as controller frame and system frame respectively in [8], and also known as mechanical frame and electrical frame respectively in [19].

Fig. 6 shows in the left-hand column the key steps in modelling the _current-angle swing_ dynamics of a grid-forming inverter. (a1) is the frequency droop equation and (a2) is linearized from using \(dq\pm\) variables. These equations show the swing relationship between the current and synchronization angle.

Later, in Section III-D, the impedance method will be used to facilitate the analysis of multi-inverter cases and so the swing equation is developed in impedance form using the frame-dynamics-embedding method [18, 19]. Starting with (a2) and Fig. 4(a), we can obtain the frequency droop virtual impedance \(Z_{\text{FD}}\) of (a3), where \(S_{i\theta}\) is the current-angle swing characteristic equation of (a4). A whole-system model that considers both the inverter and the infinite bus is then created in (a5) which uses the modified swing characteristic equation \(S^{i}_{i\theta}\) of (a6). The modified swing characteristic captures the interaction between the synchronization loop, the inner voltage loop, and external grid impedance. The representation of the voltage-loop \(Z_{c}\) can be fo
und in literature [4]. Further analysis of \(S_{i\theta}\) and \(S^{\prime}_{i\theta}\) will be given in Section III.

#### Ii-C2 PLL Grid-Following Inverter

The synchronization loop including grid feedback is shown in Fig. 3(b) and its small-signal

Fig. 4: Modeling single-inverter-infinite-bus systems in \(dq\pm\) frame. (a) Frequency droop grid-forming inverter. (b) PLL grid-following inverter. (Notes: These models are small-signal, and in complex \(dq\) frame. \(G_{s}\) is the synchronization controller. \(T\) is the transformation matrix from \(d^{\prime}q^{\prime}\pm\) frame to \(dq\pm\) frame.).

Fig. 5: Inverter frame illustration. (Notes: \(\omega\) and \(\theta\) are the large-signal angular frequency and phase angle respectively, with small-signal \(\hat{\omega}\) and \(\hat{\theta}\) and steady-state operating points \(\Omega_{0}\) and \(\Theta_{0,\lambda}\).)model in complex \(dq\) form is shown in Fig. 4(b). The grid-following inverter is repeated by a controlled current source which reflects the voltage-following current-forming feature. The admittance \(Y_{c}\) represents the dynamics of the ac filter and the inner current loop [4]. To highlight the duality between grid-forming and grid-following inverters, the infinite bus is represented by a current source with parallel admittance \(Y_{g}\) here. This is equivalent to a voltage-type infinite bus according to the Thevenin
's and Norton's theorems, as illustrated in Fig. 7.

The right-hand column in Fig. 6 sets out the swing equation of a PLL grid-following inverter. (b1) is the PLL swing equation and the linearized form is given in (b2). The duality between inverter types is seen in the grid-forming inverter having current-angle swing characteristics whereas the grid-following inverter has _voltage-angle swing_ characteristics.

Following similar steps as for the frequency droop grid-forming inverter, the frame-dynamics-embedding method in [18, 19] is used to form a virtual admittance \(Y_{\text{PLL}}\) representation of the PLL of (b3) with the voltage-angle swing characteristic equation \(S_{v\theta}\) in (b4). The whole-system model in (b5) can then be obtained, in which the current-loop virtual admittance \(Y_{c}\) can be found in [4]. \(S^{\prime}_{v\theta}\) is the swing characteristic defined in (b6) which incorporates gird interaction. Further analysis of \(S_{v\theta}\) and \(S^{\prime}_{v\theta}\) will also be given in Section III, alongside that for the grid-forming inverter.

Summarising Fig. 6, the grid-forming inverter has current-angle swing characteristics (equivalent to \(P\)-angle swing within its voltage loop bandwidth when \(v_{q}\) is constant and \(v_{q}\) is zero) whereas, as a dual, the grid-following inverter has voltage-angle swing characteristics (equivalent to \(Q\)-angle swing when \(i_{d}\) is constant and \(i_{q}\) is zero).

### _Summary of Duality_

In this section, grid-forming and grid-following inverters have been discussed in terms of synchronization loops, the forming or following of voltage and current, and the swing dynamics. The discussion has applied the same perspective to each type and shown that in many regards, the two types have duality

Fig. 6: Characteristic equations. (a) Frequency droop grid-forming inverter. (b) PLL grid-following inverter. (Notes: \(s\) is the Laplace operator. \(I_{[2\times 2]}\) is the \(2\times 2\) identity matrix. The linearization law includes \(\omega=\hat{\omega}+\Omega_{0}\), \(\theta=\hat{\theta}+\Theta_{0}\), \(v=\hat{v}+V_{0}\), and \(i=\hat{i}+I_{0}\).)

Fig. 7: Transformation between voltage-type and current-type infinite buses.

characteristics, as summarized in Table I. In next section, the analysis will be extended to stability of the synchronization to explore the duality further.

## III Duality of Small-Signal Stability

In this section, the small-signal swing characteristics in Fig. 6 will be further analyzed, to explore the duality from the perspective of stability. Case-study networks will be used to illustrate the points. The parameters used for obtaining theoretical and simulation results in this section are summarized in Appendix B.

### _Synchronization Loops With Ideal Sources: \(S_{i\theta}\) and \(S_{v\theta}\)_

The synchronization loops illustrated in Fig. 2(a) and (b) are investigated first for the simple case where the current vector detected by the frequency droop and the voltage vector detected by the PLL are steady vectors rotating with a constant angular frequency. In other words, the grid-forming inverter is required to synchronize to an ideal current source and the grid-following inverter to an ideal voltage source, without inner-loop dynamics and grid impedance. The synchronization dynamics are as described by \(S_{i\theta}\) and \(S_{v\theta}\) in (a4) and (b4) in Fig. 6. It is worth remarking that \(S_{i\theta}\) can also be derived directly by linearizing the frequency droop equation noting that \(\hat{i}_{d}=I_{q0}\hat{\theta}\); and \(S_{v\theta}\) can be derived directly by lineari
zing the PLL equation noting that \(\hat{v}_{q}=-V_{d0}\hat{\theta}\).

Taking \(G_{\text{FD}}\) as a droop gain with an LPF (\(m\frac{1}{1+T_{f}s}\)) and \(G_{\text{PLL}}\) as a PI controller (\(k_{p,\text{PLL}}+\frac{k_{i,\text{PLL}}}{s}\)), \(S_{i\theta}\) and \(S_{v\theta}\) can be written as

\[S_{i\theta}=s^{2}\underbrace{\frac{T_{f}}{m}}_{J}+s\underbrace{\frac{1}{m}}_{ K_{D}}+\underbrace{(-I_{q0})}_{K_{S}} \tag{1}\]

and

\[S_{v\theta}=\frac{1}{1+s\frac{k_{p,\text{PLL}}}{k_{i,\text{PLL}}}}_{J}+s \underbrace{\frac{k_{p,\text{PLL}}}{k_{i,\text{PLL}}}V_{d0}}_{K_{D}}+ \underbrace{V_{d0}}_{K_{S}} \tag{2}\]

The forms of \(S_{i\theta}\) and \(S_{v\theta}\) are not perfectly duals here because of the difference between controllers \(G_{\text{FD}}\) and \(G_{\text{PLL}}\), but, notwithstanding that, both \(S_{i\theta}\) and \(S_{v\theta}\) have characteristics similarly to a virtual synchronous generator with inertia \(J\), damping torque coefficient \(K_{D}\), and synchronizing torque coefficient \(K_{S}\) as identified in the equations. In particular, the time-constant of the LPF in \(G_{\text{FD}}\) and the integral gain of the PI controller in \(G_{\text{PLL}}\) contribute the virtual inertia \(J\).

Unlike this simple case, the current and voltage vectors measured by frequency droop and PLL are not constant in practice, and further analysis of \(S_{i\theta}\) and \(S_{v\theta}\) is needed next.

### _Single-Inverter-Infinite-Bus Systems: \(S^{\prime}_{i\theta}\) and \(S^{\prime}_{v\theta}\)_

For single-inverter-infinite-bus systems (Fig. 3 and Fig. 4) the current and voltage at the connection point to the inverters synchronize are not constant, and instead are subject to interactions between the grid impedance/admittance (\(Z_{g}\) and \(Y_{g}\)), the synchronization controllers (\(Z_{\text{FD}}\) and \(Y_{\text{PLL}}\)), and the inner-loop controllers (\(Z_{c}\) and \(Y_{c}\)). The swing characteristics \(S_{i\theta}\) and \(S_{v\theta}\) are modified to \(S^{\prime}_{i\theta}\) and \(S^{\prime}_{v\theta}\) through the introduction of interaction terms \((Z_{\text{FD}}+Z_{c})Z^{-1}_{g}\) and \((Y_{\text{PLL}}+Y_{c})Y^{-1}_{g}\) respectively.

To explore the factors that influence the stability of the synchronization of both forms of inverter, the root loci of \(S^{\prime}_{i\theta}\) and \(S^{\prime}_{v\theta}\) are plotted as three parameters are varied: grid impedance in Fig. 8, synchronization gain in Fig. 9, and inner-loop gain in Fig. 10. In each case, sub-figures (a) and (c) are for frequency droop grid-forming and sub-figures (b) and (d) for PLL grid-following.

Fig. 9: Illustration of synchronization stability with variation of synchronization controller gains. (a) Root loci of \(S^{\prime}_{i\theta}\) for grid-forming with droop gain \(m\) increased from 0.05 up to 0.2 up. (b) Root loci of \(S^{\prime}_{i\theta}\) for grid-following with PLL bandwidth \(m\), increased from 15 Hz to 60 Hz. (c) Simulation of grid-forming as \(m\) is increased at 0.2 s and changed back at 0.4 s. (d) Simulation of grid-following as \(\omega_{\text{PLL}}\) is increased at 0.2 s and changed back at 0.4 s.

Fig. 8 shows that reducing \(Z_{g}\) for the grid-forming inverter and reducing \(Y_{g}\) for the grid-following inverter lead to the right-half plane roots and instability. In other words, a grid-following inverter is vulnerable to weak grid with low \(Y_{g}\), which agrees with the consensus in the literature [8, 9]. As a dual, a grid-forming inverter is vulnerable to strong grid with low \(Z_{g}\). This observation is somewhat surprising at the first glance and has rarely been reported in literature [3, 6], but follows from the duality that has been established. It also warns that the grid-forming inverter is not always a good choice. Additionally, it is also worth mentioning that the grid-forming inverter investigated here uses double-loop control (an inner current loop and an outer vo
ltage loop) for voltage forming and droop control (active power frequency droop) for synchronization [4]. There are alternative control options available, such as open-loop voltage control, single-loop voltage control, virtual synchronous generator control, and virtual impedance control. The effect of grid strength on their stability may be different and will require further study before a general conclusion can be formed. It is also worth noting that some of the available control methods have been shown to be equivalent [4, 5, 20].

Fig. 9 shows that increasing the droop gain \(m\) of the grid-forming inverter (i.e., increasing \(G_{\text{FD}}\) and \(Z_{\text{FD}}\)) and increasing the PLL bandwidth \(\omega_{\text{PLL}}\) of the grid-following inverter (i.e., increasing \(G_{\text{PLL}}\) and \(Y_{\text{PLL}}\)) lead to the instability. In other words, the larger of synchronization controller gains, the more prone inverters become to instability.

Fig. 10 shows that reducing the voltage loop bandwidth of the grid-forming inverter (i.e., increasing \(Z_{c}\)[4]) and reducing the current loop bandwidth of the grid-following inverter (i.e., increasing \(Y_{c}\)[4]) lead to the instability. In other words, the lower the inner-loop bandwidth, the greater the chance of unstable interaction.

Sub-figures (c) and (d) in Fig. 8, Fig. 9 and Fig. 10 show time-domain simulation results which confirm the theoretical analysis in (a) and (b). At 0.2 s, parameters are tuned in the direction the root loci indicate which leads to the instability. The oscillations are observed to be at the frequencies predicted by root loci. At 0.4 s, the parameters are returned to their initial values which re-stabilizes the system.

It is worth observing that the unstable modes discussed in this subsection are caused by insufficient damping coefficient (or damping torque) rather than insufficient synchronizing coefficient (or synchronizing torque). Insufficient damping coefficient occurs in a duality fashion: grid-forming with low grid impedance; grid-following with high grid impedance. This instability can generally able be avoided by tuning controllers (as seen in Fig. 9 and Fig. 10) or by changing inner-loop control structures [4]. Care is need, though, since there may be additional constraints on the controllers in practice which might limit the freedom to tune their parameters to enhance the small-signal stability. For example, the droop gain of grid-forming inverter is limited by the frequency variation limit sp
ecified in a grid code; and the inner loop bandwidths of inverters are limited by the switching and sampling frequency of the inverter hardware. In contrast to duality present in insufficient damping coefficient discussed above, insufficient synchronizing coefficient for both grid-forming and grid-following inverters occurs when the grid is very weak [2, 9, 21]. This case is related to the power transfer characteristic between two node voltages separated by an impedance. It is accompanied by the well-known limit on power transfer capability and is sensitive to the power flow [21]. Under this condition there would be a direct loss of synchronization rather than an unstable oscillations. A further type of high-frequency instability is known and occurs when the bandwidth of the inner loop is 
too high. This is known as harmonic or super-synchronous instability [22] and is distinctly different from the interaction instability caused by an inner loop that is too slow as in Fig. 10.

In conclusion, the imperative of stable synchronization of the two types of inverters places similar upper limits on synchronization controller gains and similar lower limits for the inner voltage- or current-loop controller gains but duality limits on grid strength, namely, a lower limit on the grid impedance for grid-forming but an upper limit on grid impedance (or low limit on admittance) for grid-following. All these observations point to the same conclusion: the larger the interaction terms in \(S^{\prime}_{i\theta}\) and \(S^{\prime}_{v\theta}\), the higher likelihood of instability. A summary of these discussions are also included in Table I.

### _Rethinking Grid Strength_

As discussed in previous subsections, grid strength plays a role in inverter stability. In looking again at grid strength with the duality principle in mind, a normally overlooked fact is recalled that the term "grid" in grid strength is taken to mean a voltage grid rather than a current grid. Therefore, we might re-define the conventional grid strength more precisely as _grid voltage

Fig. 10: Illustration of synchronization stability with variation of inner-loop controller gains. (a) Root loci of \(S^{\prime}_{i\theta}\) for grid-forming with voltage control bandwidth index \(\omega_{v}\) reduced from 250 Hz to 150 Hz. (b) Root loci of \(S^{\prime}_{g}\) for grid-following with current control bandwidth index \(\omega_{i}\) decreased from 250 Hz to 150 Hz. (c) Simulation of grid-forming as \(\omega_{v}\) is reduced at 0.2 s and changed back at 0.4 s. (d) Simulation of grid-following as \(\omega_{i}\) is reduced at 0.2 s and changed back at 0.4 s.

strength_ and, as a dual, also define the term _grid current strength_, as illustrated in Fig. 11. Even though any source or bus can be represented as either voltage or current type through Thevenin's and Norton's theorems, the grid nowadays as we know is "closer" physically to a voltage source with relatively low equivalent series impedance. It has a high voltage strength when \(Z_{g}\) is small and becomes an ideally strong (or stiff) voltage source when \(Z_{g}=0\). As a dual, a grid has a high current strength when \(Y_{g}\) is small and becomes an ideally strong (or stiff) current source when \(Y_{g}=0\). A short circuit can be regarded as an ideal voltage source with \(v_{g}=0\) and \(Z_{g}=0\); and open circuit can be regarded as an ideal current source with \(i_{g}=0\) and \(Y_{g}=
0\).

This wider interpretation of grid strength also helps to form intuitive understanding of the grid strength stability discussed in previous subsection. A grid-forming inverter (voltage-forming, current-following) is vulnerable to a strong grid and cannot operate with short-circuit (voltage-strong, current-weak). As a dual, a grid-following inverter (current-forming, voltage-following) is vulnerable to a weak grid and cannot operate with open-circuit (current-strong, voltage-weak). This is also summarized in Table I.

### _A Multi-Inverter Power System_

A network with several IBRs, shown in Fig. 12 is tested next. It has the same layout and line impedances as the standard IEEE 14-bus test network [23], but all the synchronous generators have been replaced by either grid-forming inverters (blue) or grid-following inverters (red). The whole-system impedance model can be readily constructed by connecting the inverter impedance model in Fig. 6 to the dynamic nodal admittance matrix of transmission lines [18, 19]. System stability can then be evaluated by observing the poles of the whole-system model in Fig. 13(a). To study a change in grid strength, the impedances of lines \(Z_{12}\) and \(Z_{15}\), connecting GFM1, are reduced from the standard values of \(0.019+j0.059\) pu and \(0.054+j0.22\) pu (poles in blue) to one fifth of those values 
(poles in red). This higher voltage strength connections leads to a 17.3 Hz unstable oscillation (a strong-grid instability). This is confirmed by simulation results in Fig. 13(b). At 0.4 s, \(Z_{12}\) and \(Z_{15}\) are reduced, which leads to the unstable oscillation. At 0.8 s, \(Z_{12}\) and \(Z_{15}\) are increased back to their standard values and the system becomes stable again.

As a dual, increasing the impedances of lines can also lead to the weak-grid instability of GFL2 or GFL8, which has been widely discussed in literature [8, 9, 14, 19] and is not examined further here.

## IV Duality of Transient Stability

The analysis thus far (e.g., the characteristic equations in Fig. 6 and the interaction analysis in Section III-B) has focused on small-signal instability, i.e., instability to perturbations around a given operating point. In practice, power grids are also required to be robust under abnormal operation (e.g., island operation) and severe disturbance (e.g., temporary short-circuit fault). This is known as the large-signal stability or transient stability. It is known that grid-forming inverters are established as a method for island operation with a formed grid voltage, duality can be used to operate an island with a formed grid current by grid-following inverters. Additionally, the transient stability of both grid-forming and -following inverters can be assessed in a similar manner to sync
hronous generators [2] with the virtual inertia and virtual damping being considered in place of physical inertia and damping torque. These two aspects of duality will now be discussed.

### _Single-Inverter System: Island Operation and Frequency Stability_

The ability of grid-forming inverters to operate in electrical islands has been widely known for some time [4, 10]. In contrast, the ability of a grid-following inverter to do the same is controversial [9] because of the stereotype of "following". As discussed in Section II-B, the grid-following inverter is more precisely a voltage-following current-forming inverter, and hence, it could form an island grid (current rather than voltage). To test this idea, a PLL grid-following inverter is simulated with a passive \(RL\) load (\(1+j0.2\) pu) in islanding mode. The system layout is shown in Fig. 14(a). The result in Fig. 15, shows that

Fig. 11: Duality of grid strength.

Fig. 12: A modified IEEE 14-bus inverter-based power system. (Notes: GFM indicates grid-forming, and GFL indicates grid-following).

from 0 s to 0.4 s, the inverter is stable and controls its current reference with \(i_{d}=i_{d}^{*}=-0.5\) pu and \(i_{q}=i_{q}^{*}=\) 0.09 pu. Note that \(v_{d}\) is approximately 0.5 pu rather than 1 pu because the voltage results from the inverter current and load impedance as determined by the Ohm's law.

At 0.4 s, \(i_{q}^{*}\) is changed from 0.09 pu to 0 pu, which, via Ohm's law, creates a non-zero \(v_{q}\). The integrator of the PI controller in the PLL seeks to drive \(v_{q}\) to zero by unremittingly increasing \(\omega\). With the load and current references chosen, no equilibrium exists and the system frequency is unstable. At 0.8 s, the integrator was disabled by setting \(k_{i,\text{PLL}}=0\), which removes the contradiction and re-stabilizes the frequency. With the integrator removed, the PLL becomes a simple \(v_{q}\)-\(\omega\) droop with a proportional droop gain of \(k_{p,\text{PLL}}\). This further illustrates the duality between PLL and frequency droop and emphasises that some of the difference arise from presence or absence of integrator action.

In conclusion, the grid-following inverter is able to form grid current and operate in an islanding mode with a stable frequency but a widely varying grid voltage can occur because of the combination of the \(i_{dg}^{*}\) setting and load impedance. Further, the PI function within the PLL can mean that there are current reference choices for which no equilibrium condition exists.

### _Two-Inverter System: Angle Stability_

As demonstrated by the analysis in previous subsection, a single grid-following inverter can feed a load in an island configuration, and operate robustly, thanks to the duality between current-forming and voltage-forming and between PLL and frequency droop control. Here, we further explore the principles of the angle stability for three different two-inverter systems in Fig. 16.

The first case, Fig. 16(a), consists of two grid-forming inverters (voltage sources). The transient stability will be similar to the \(P\)-\(\theta\) swing of a conventional synchronous-generator-dominated system [5] and we briefly review the principle again here. The large-signal swing interaction of two grid-forming inverters can be represented by

\[J\bar{\theta}_{\Delta}=P_{\Delta}^{*}-P_{\Delta}, \tag{3}\]

where \(J\) is the virtual inertia; \(\theta_{\Delta}=\theta_{1}-\theta_{2}\) is voltage angle difference; \(P_{\Delta}^{*}=P_{1}^{*}-P_{2}^{*}\) is the difference between the power

Fig. 14: System layout of the island operation of grid-following inverters. (a) Single-inverter case. (b) Two-inverter case.

Fig. 13: (a) Pole loci of the whole-system with the standard line impedances (blue) and with \(Z_{12}\) and \(Z_{15}\) reduced to one fifth (red). (b) Simulation results for frequency, current and voltage at the five IBR buses. \(Z_{12}\) and \(Z_{15}\) are reduced at 0.4 s and revert at 0.8 s.

Fig. 15: Test results for the island operation of a grid-following inverter; \(i_{q}^{*}\) is changed from 0.09 pu to 0 pu at 0.4 s and \(k_{i,\text{PLL}}\) is changed from its nominal value to 0 at 0.8 s.

set points of the droop controls; \(P_{\Delta}=P_{1}-P_{2}\) is the difference between the active powers. This swing interaction equation can be readily obtained by taking the difference between the swing equations of two grid-forming inverters. When the impedance \(Z\) is purely inductive, that is \(jX\), in Fig. 16(a), the synchronizing power \(P_{\Delta}\) can be represented by

\[P_{\Delta}=2\frac{V_{1}V_{2}}{X}\sin(\theta_{\Delta}), \tag{4}\]

i.e., a sine dependence on \(P_{\Delta}\)-\(\theta_{\Delta}\). Fig. 16(a) plots this relation and shows both a stable equilibrium point (SEP) and an unstable equilibrium point (UEP). The equilibrium is an SEP when \(\theta_{\Delta}\) is less than \(90^{\circ}\). Further, the smaller \(\theta_{\Delta}\), the larger is the maximum decelerating area (MDA) and the wider is the range of first-swing transient stability [2].

The second case, Fig. 16(b), consists of two grid-following inverters (current sources). According to the analysis in Section II-C and Section III-A, grid-following inverters have \(V\)-\(\theta\) or \(Q\)-\(\theta\) swing characteristics. We consider the reactive power format here,

\[J\ddot{\theta}_{\Delta}=Q_{\Delta}^{*}-Q_{\Delta}, \tag{5}\]

where \(\theta_{\Delta}=\theta_{1}-\theta_{2}\) is the current angle difference; \(Q_{\Delta}^{*}=-(Q_{1}^{*}-Q_{2}^{*})\) is the difference of the reactive power set points (or equivalently \(v_{q}^{*}\)) used in PLL and \(Q_{\Delta}=-(Q_{1}-Q_{2})\) is the difference of reactive powers. When the admittance \(Y\) in Fig. 16(b) is pure resistive, that is \(G\), we have

\[Q_{\Delta}=2\frac{I_{1}I_{2}}{G}\sin(\theta_{\Delta}). \tag{6}\]

i.e., a sine dependence on \(Q_{\Delta}\)-\(\theta_{\Delta}\). This means that the two-GFL system in Fig. 16(b) may be expected to have a similar transient characteristic to the two-GFM system. In other words, two grid-following inverters should also be able to synchronize to each other without the existence of a voltage source (i.e., islanding mode) when the system impedance is resistance-dominated (i.e., passive loads are connected). This is barely reported in literature and therefore is tested here shown in Fig. 17. Prior to the 0.2 s point, both GFL1 and GFL2 operate stably. At 0.2 s, a temporary short-circuit fault is applied at bus 2. The fault reduces the voltage at the two grid-following inverters and leads to a surge of current and a perturbation of frequency. After three fundamen
tal periods, at 0.26 s, the temporary fault is cleared. GFL1 and GFL2 re-establish grid currents (through action of the inner loop controller), re-synchronize with each other (through action of the PLL or equivalently \(v_{q}\)-\(\omega\) droop or equivalently \(Q\)-\(\omega\) droop), and return the bus voltage back to its nominal value (through supply of current through the loads at the buses).

Next the third case, Fig. 16(c), the interaction between a grid-following and a grid-forming inverters, is investigated. The swing equations of GFL1 and GFM2 are, respectively,

\[J_{1}\ddot{\theta}_{1} =-Q_{1}^{*}+\underbrace{XI_{1}^{2}-V_{2}I_{1}\sin(\theta_{1}- \theta_{2})}_{Q_{1}}\] \[J_{2}\ddot{\theta}_{2} =P_{2}^{*}-\underbrace{\left(-V_{2}I_{1}\cos(\theta_{1}-\theta_{2} )\right)}_{P_{2}}. \tag{7}\]

When \(J_{1}\gg J_{2},\ddot{\theta}_{1}\ll\ddot{\theta}_{2},\ddot{\theta}_{\Delta} \approx-\ddot{\theta}_{2}\). This means that the grid-forming inverter synchronizes to the grid-following inverter. As

Fig. 16: Angle stability analysis of different two-inverter systems. (a) Grid-forming inverters: Two-GFM system. (a) Grid-following inverters: Two-GFL system. (c) Interaction between grid-following and grid-forming inverters: GFL-GFM system.

Fig. 17: Test results for the island operation and synchronization of two grid-following inverters in Fig. 14(b). A temporary short-circuit fault happens to bus 2 at 0.2 s and is then cleared at 0.26 s. (a) GFL1. (b) GFL2. (c) Current angle difference of GFL1 and GFL2.

a consequence, the whole-system swing interaction equation is

\[J_{2}\ddot{\theta}_{\Delta}=\underbrace{-P_{2}^{*}}_{S_{\Delta}^{\Delta}}- \underbrace{V_{2}I_{1}\cos(\theta_{\Delta})}_{S_{\Delta}^{\Delta}}, \tag{8}\]

which is dominated by the second equation in (7), i.e., the swing dynamics of the grid-forming inverter GFM2. This equation indicates a cosine relation between the synchronizing power \(S_{\Delta}\) and the angle difference \(\theta_{\Delta}\), as plotted in blue in Fig. 16(c). In contrast, when \(J_{1}\ll J_{2}\), \(\theta_{1}\gg\theta_{2}\), \(\tilde{\theta}_{\Delta}\approx\tilde{\theta}_{1}\). This means that the grid-following inverter synchronizes to the grid-forming inverter. The whole-system swing interaction is dominated by the first equation in (7), i.e., the swing dynamics of the grid-following inverter GFL1, as

\[J_{1}\ddot{\theta}_{\Delta}=\underbrace{-Q_{1}^{*}+XI_{1}^{2}}_{S_{\Delta}^{ \Delta}}-\underbrace{V_{2}I_{1}\sin(\theta_{\Delta})}_{S_{\Delta}}. \tag{9}\]

This gives a sine \(S_{\Delta}\)-\(\theta_{\Delta}\) relation, as plotted in red in Fig. 16(c). It is worth mentioning that, for different ratios \(J_{1}/J_{2}\), the system has different power-angle relations and different swing curves, and therefore different SEPs. This notion was tested in simulation with results shown in Fig. 18. Prior to the 1 s point, the system operates stably by using the rated parameters in Table B1. We can observe that \(90^{\circ}>\theta_{\Delta}>0^{\circ}\), which means the whole-system operates at SEP1 (red curve) in Fig. 16(c) with \(J_{1}\ll J_{2}\) (the grid-following inverter synchronizes to the grid-forming inverter). At 1 s, the virtual inertia \(J_{1}\) of GFL1 is increased to infinite by setting the PI controller of PLL to zero, i.e., an unchanged outp
ut frequency of PLL. This sudden change leads to \(J_{1}\gg J_{2}\) (the grid-forming inverter synchronizes to the grid-following inverter), and forces the system to move from SEP1 on the red curve to USP on the blue curve in Fig. 16(c). Thereafter, the system leaves the UEP and gradually converges to SEP2 on the blue curve with \(0^{\circ}>\theta_{\Delta}>-90^{\circ}\).

In conclusion for this subsection, just as two grid-forming inverters can synchronize to each other, two grid-following inverters can also synchronize to each other and operate stably. A grid-forming and a grid-following inverter can also synchronize to each other with a characteristic that depends on their relative inertias, i.e., the one with the lower inertia dominates the swing dynamics. This further exemplifies the duality between grid-forming and grid-following inverters. However, it is worth noting that, the specific power-angle (\(S_{\Delta}\)-\(\theta_{\Delta}\)) relation and swing dynamics of the whole system are influenced by many factors including the types of inverters (grid-forming, grid-following), the virtual inertia values of inverters (large, small), the types of impedanc
e of grid networks and loads (resistive, inductive, capacitive), and the steady-state operating points. This means that obtaining an interpretable and concise analytical solution for the transient swing dynamics of a multi-inverter system would be challenging and needs further detailed investigations in the future [21]. In next subsection, the qualitative analysis of a multi-inverter system will be explored, with the help of time-domain simulations.

### _Multi-Inverter System: Virtual Inertia and Virtual Damping_

In this subsection, parameters influencing the synchronization transient stability of a multi-inverter system are further considered. The swing equations (1) and (2) derived in Section III-A are recalled here: For a grid-forming inverter, the virtual inertia \(J\) and virtual damping \(K_{D}\) are represented by \(T_{f}/m\) and \(1/m\) respectively, i.e., determined by the time constant \(T_{f}\) of the LPF and the droop gain \(m\); For a grid-following inverter, the virtual inertia \(J\) and virtual damping \(K_{D}\) are represented by \(1/k_{i,\text{PLL}}\) and \(V_{40}k_{p,\text{PLL}}/k_{i,\text{PLL}}\), i.e., influenced by the PLL PI controller. Note that \(J\) and \(K_{D}\) for the grid-forming inverter and \(J\) for the grid-following inverter are not dependent on the steady-state op
erating point, which means they can be directly used for transient stability analysis. As for \(K_{D}\) of the grid-following inverter, as long as \(d\)-axis voltage \(V_{40}\) is positive, \(K_{D}\) is positively proportional to \(k_{p,\text{PLL}}/k_{i,\text{PLL}}\). For both inverters, the larger of \(J\) and \(K_{D}\), and the greater the chance of stable transients, like a synchronous generator. This principle will now be verified using the 14-bus system in Fig. 12.

Fig. 18: Test results of the synchronization between a grid-following and a grid-forming inverters in Fig. 16(c). At 1 s, the virtual inertia \(J_{1}\) of GFL1 is increased to infinite by setting the PI controller gains of PLL to zero.

Results from the test system are displayed in Fig. 19 with grid-forming examined in (a) and grid-following in (b). In both cases, a short-circuit fault was applied at 0.2 s at bus 6 (the approximate center in the grid). The fault was cleared three fundamental periods later [24], i.e., at 0.26 s. In Fig. 19(a) results for different values of droop gain \(m\) are shown. When the droop gain is small (0.01 pu), the system recovers to its pre-fault operating point after the fault is cleared (dashed line in the figure). When droop gain is large (0.08 pu, solid line in the figure), the system is seen to be small-signal stable before the fault occurs (before 0.2 s), but following the transient disturbance of the fault it does not recover to stable operation at its original operating point and is t
herefore has a large-signal instability. This observation is consistent with the swing (1) for this case where a large droop gain creates a small inertia and small damping in the grid-forming inverter and as a result there is a greater chance of transient instability.

Fig. 19(b) shows the transient stability with different values of the PLL integral gain \(k_{i,\text{PLL}}\) of the grid-following inverter. When \(k_{i,\text{PLL}}\) is small (dashed line), the system is stable. When \(k_{i,\text{PLL}}\) is large (solid line), the system is small-signal stable, but does not recover to its original operating point after the fault event and therefore is large-signal unstable. This observation also consistent with the swing equation (2) because a large \(k_{i,\text{PLL}}\) indicates small virtual inertia and small damping of the grid-following inverter.

Comparing Fig. 19(a) and (b), it is seen that the grid-forming inverter GFM6 suffers a loss of synchronism and frequency collapse in (a) whereas it is the grid-following inverter GFL8 that looses synchronism in (b). In both cases, but particularly there are disturbances to other IBR but no loss of synchronism. This also illustrates that the main source of the transient instability is different in grid-forming and grid following cases.

## V Conclusion

An examination of synchronization loops of grid-forming and grid-following inverters has revealed a set of properties which are duals of each other. This extends well beyond the simple observation that one acts as a voltage source and the other as a current source. The duality reveals similarities and differences between the two types that can aid our understanding of how instability can arise in inverter networks and what measures can be taken to combat instability. The duality is seen in the following points.

1. [label=)]
2. Converse synchronization loop. The \(P\)-\(\omega\) droop control for a grid-forming inverter is equivalent to \(i_{d}\)-\(\omega\) droop control when \(v_{d}\) is constant and \(v_{q}\) is 0, which can further be regarded as a PLL acting on \(i_{d}\) with a proportional phase-locking controller. The PLL for a grid-following inverter acting on \(v_{q}\) can be regarded as \(v_{q}\)-\(\omega\) droop control with a PI droop gain and further is equivalent to \(Q\)-\(\omega\) droop control when \(i_{d}\) is constant and \(i_{q}\) is 0.
3. Converse grid-interfacing characteristics. The grid-forming inverter is current-following and voltage-forming. The grid-following inverter is voltage-following and current-forming.
4. Converse swing characteristics. The grid-forming inverter has a current-angle swing or, equivalently, a active-power-angle swing. The grid-following inverter has a voltage-angle swing or, equivalently, reactive-power-angle swing.
5. Similar controller gain characteristics (converse impedance/admittance shaping). For grid-forming and grid-following, the larger the synchronization controller gains (frequency droop gain and PLL bandwidth) or the smaller the inner-loop controller gains (voltage- and current-loop bandwidths), the higher the likelihood of interaction and synchronization instability.
6. Converse grid strength compatibility. The grid-forming inverter is vulnerable to strong grid with low grid impedance (strong grid voltage and weak grid current). The grid-following inverter is vulnerable to weak grid with low grid admittance (strong grid current and weak grid voltage).
7. Similar transient stability mechanism. The transient stability of both the grid-forming inverter and grid-following inverter depends on their swing equation, virtual inertia, and virtual damping. Like a grid-forming inverter, a grid-following inverter can also operate in island mode or synchronize to another grid-following inverter without a voltage source present. A grid-forming inverter and a grid-following inverter can also synchronize to each other depending on their virtual inertia values.

The duality interpretation proposed here has been shown to unify the view of grid-synchronization and grid-interfacing characteristics of two types of inverter in a symmetric and elegant form. This unified view can not only offer promising pathway towards multi-inverter analysis which is missing now [21], but also inspire novel concepts (such as \(i_{d}\)-PLL, \(v_{q}\)-\(\omega\)

Fig. 19: Transient stability test when a temporary fault occurs in bus 6 at 0.2 s and is cleared at 0.26 s. The dashed line represents stable test and solid line indicates the unstable test. (a) Droop gain of grid-forming inverter is reduced to 0.01 pu (dashed line) or increased to 0.08 pu (solid line). (b) PLL integral gain of grid-following inverter is reduced by 10 times (dashed line) or increased by 10 times (solid line).

droop, voltage/current-forming/following, and voltage/current strength) and help to interpret surprising phenomena (such as strong grid instability of grid-forming inverters and islanding grid-following inverters). It is anticipated that the use of duality can also be applied to or incorporated with other power engineering theories and lead to further new interpretations of future power systems. But it is also remarked that not all properties are duals because some proprieties relate to the voltage-dominated sources, parallel-connected apparatuses, and inductor-dominated lines of grids nowadays, and the format of controller in the synchronization loop. This may lead to different roles of two types of inverters in different research areas (voltage stability, power quality, etc) and may make
 the analysis of multi-inverter systems challenging, which needs further studies.

## Appendix A Fundamentals of Complex \(dq\) Frame

The complex \(dq\) frame (\(dq\pm\) frame) [4, 16, 17] is used for small-signal analysis in this article. For an arbitrary signal \(u_{dq}\) in \(dq\) frame, the corresponding complex signal \(u_{dq\pm}\) in \(dq\pm\) frame can be obtained as

\[\underbrace{\begin{bmatrix}u_{+}\\ u_{-}\end{bmatrix}}_{u_{dq}}=\underbrace{\begin{bmatrix}1&j\\ 1&-j\end{bmatrix}}_{T_{j}}\underbrace{\begin{bmatrix}u_{d}\\ u_{q}\end{bmatrix}}_{u_{dq}} \tag{10}\]

where \(u_{+}=u_{d}+ju_{q}\) and \(u_{-}=u_{d}-ju_{q}\) are the forward and backward complex space vectors, respectively; and \(T_{j}\) is the transformation matrix. According to this transformation law, for a \(dq\) frame system model

\[\underbrace{\begin{bmatrix}y_{d}\\ y_{q}\end{bmatrix}}_{y_{dq}}=\underbrace{\begin{bmatrix}G_{dd}&G_{dq}\\ G_{dq}&G_{qq}\end{bmatrix}}_{G_{dq}}\underbrace{\begin{bmatrix}u_{d}\\ u_{q}\end{bmatrix}}_{u_{dq}} \tag{11}\]

we can get the corresponding \(dq\pm\) frame model as

\[\underbrace{\begin{bmatrix}y_{+}\\ y_{-}\end{bmatrix}}_{y_{dq\pm}}=\underbrace{\begin{bmatrix}G_{+}&G_{-}\\ \overline{G}_{-}&\overline{G}_{+}\end{bmatrix}}_{G_{dq\pm}}\underbrace{\begin{bmatrix} u_{+}\\ u_{-}\end{bmatrix}}_{u_{dq\pm}} \tag{12}\]

with

\[G_{dq\pm}=T_{j}G_{dq}T_{j}^{-1} \tag{13}\]

where the overbar in \(G_{dq\pm}\) indicates the conjugate operation. For power system applications, \(G_{dq\pm}\) normally has a simpler and more symmetric mathematical structure than \(G_{dq}\), which facilitates the analysis [4, 16].

## Appendix B Parameters

If not specified, rated parameters in Table B1 are used when obtaining the results of single-inverter cases in Section III. For the 14-bus multi-inverter case, parameters are available online at [25].

## References
